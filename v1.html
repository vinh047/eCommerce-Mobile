<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Chi tiết sản phẩm - iPhone 15</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "Roboto", "ui-sans-serif", "system-ui"],
            },
            colors: {
              primary: { DEFAULT: "#2563EB" },
            },
            boxShadow: {
              soft: "0 6px 18px rgba(17, 24, 39, 0.08)",
            },
          },
        },
      };
    </script>
    <style>
      :root {
        --phone-color: #111827;
        --thumb-selected: #2563eb;
      }
      .phone-svg .body {
        fill: var(--phone-color);
      }
      .thumb-selected {
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.3);
      }
      .focus-ring:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.35);
      }
      .tab-active {
        color: #2563eb;
      }
      .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-900 font-sans">
    <!-- Toast -->
    <div
      id="toast"
      class="fixed top-4 left-1/2 -translate-x-1/2 z-[100] hidden"
    >
      <div
        class="rounded-xl bg-white shadow-soft border border-gray-200 px-4 py-3 text-sm text-gray-800 flex items-center gap-3"
      >
        <span
          id="toastIcon"
          class="w-5 h-5 rounded-full bg-primary text-white grid place-items-center"
          >✓</span
        >
        <span id="toastText">Đã thêm vào giỏ</span>
      </div>
    </div>

    <!-- Header -->
    <header
      class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-gray-200"
    >
      <div class="max-w-7xl mx-auto px-4 md:px-6">
        <div class="flex items-center justify-between gap-4 py-3">
          <!-- Logo -->
          <a
            href="#"
            class="flex items-center gap-2 group"
            onclick="event.preventDefault()"
          >
            <div
              class="w-9 h-9 rounded-xl bg-primary text-white grid place-items-center shadow-soft"
            >
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <rect
                  x="6"
                  y="2"
                  width="12"
                  height="20"
                  rx="3"
                  fill="currentColor"
                />
                <circle cx="12" cy="18" r="1.2" fill="white" />
              </svg>
            </div>
            <span class="text-lg font-semibold tracking-tight">MobileX</span>
          </a>

          <!-- Search -->
          <form id="searchForm" class="hidden md:flex flex-1 max-w-2xl mx-4">
            <div class="relative flex-1">
              <input
                id="searchInput"
                class="w-full pl-11 pr-4 py-2.5 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 transition focus-ring focus-ring:shadow-none text-gray-800 placeholder:text-gray-400"
                placeholder="Tìm sản phẩm, thương hiệu, phụ kiện..."
              />
              <div
                class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400"
              >
                <svg width="18" height="18" fill="none" viewBox="0 0 24 24">
                  <path
                    d="M21 21l-4.3-4.3m1.3-5.2a6.5 6.5 0 11-13 0 6.5 6.5 0 0113 0z"
                    stroke="currentColor"
                    stroke-width="1.8"
                    stroke-linecap="round"
                  />
                </svg>
              </div>
            </div>
            <button
              class="ml-3 px-4 rounded-xl bg-primary text-white font-medium hover:bg-blue-700 transition focus-ring"
              type="submit"
            >
              Tìm kiếm
            </button>
          </form>

          <!-- Actions -->
          <div class="flex items-center gap-2">
            <button
              class="p-2 rounded-lg hover:bg-gray-100 transition focus-ring"
              aria-label="Tài khoản"
            >
              <svg
                width="22"
                height="22"
                viewBox="0 0 24 24"
                fill="none"
                class="text-gray-700"
              >
                <path
                  d="M12 12a5 5 0 100-10 5 5 0 000 10zM3 22a9 9 0 1118 0"
                  stroke="currentColor"
                  stroke-width="1.7"
                  stroke-linecap="round"
                />
              </svg>
            </button>
            <div class="relative">
              <button
                id="cartBtn"
                class="relative p-2 rounded-lg hover:bg-gray-100 transition focus-ring"
                aria-label="Giỏ hàng"
              >
                <svg
                  width="22"
                  height="22"
                  viewBox="0 0 24 24"
                  fill="none"
                  class="text-gray-700"
                >
                  <path
                    d="M6 6h14l-1.2 7H8.3L7 3H3"
                    stroke="currentColor"
                    stroke-width="1.7"
                    stroke-linecap="round"
                  />
                  <circle cx="9" cy="20" r="1.5" fill="currentColor" />
                  <circle cx="18" cy="20" r="1.5" fill="currentColor" />
                </svg>
                <span
                  id="cartCount"
                  class="absolute -top-1.5 -right-1.5 text-[10px] min-w-[18px] h-[18px] px-1 rounded-full bg-primary text-white grid place-items-center"
                  >0</span
                >
              </button>
              <!-- Mini Cart -->
              <div
                id="miniCart"
                class="hidden absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-xl shadow-soft p-4"
              >
                <div class="flex items-center justify-between mb-2">
                  <h4 class="font-semibold text-gray-800">Giỏ hàng</h4>
                  <button
                    class="text-gray-500 hover:text-gray-700 text-sm"
                    onclick="toggleMiniCart(false)"
                  >
                    Đóng
                  </button>
                </div>
                <div id="miniCartList" class="space-y-3 max-h-64 overflow-auto">
                  <p class="text-gray-500 text-sm">Chưa có sản phẩm nào.</p>
                </div>
                <div class="mt-4 flex items-center justify-between">
                  <span class="text-sm text-gray-600">Tạm tính</span>
                  <span id="miniCartSubtotal" class="font-semibold">0₫</span>
                </div>
                <div class="mt-3 grid grid-cols-2 gap-2">
                  <button
                    class="px-3 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-sm"
                    onclick="toggleMiniCart(false)"
                  >
                    Tiếp tục
                  </button>
                  <button
                    class="px-3 py-2 rounded-lg bg-primary text-white hover:bg-blue-700 text-sm"
                    onclick="demoCheckout()"
                  >
                    Thanh toán
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Mobile search -->
        <form id="searchFormMobile" class="md:hidden pb-3">
          <div class="relative">
            <input
              id="searchInputMobile"
              class="w-full pl-11 pr-4 py-2.5 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 transition text-gray-800 placeholder:text-gray-400"
              placeholder="Tìm sản phẩm..."
            />
            <div
              class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400"
            >
              <svg width="18" height="18" fill="none" viewBox="0 0 24 24">
                <path
                  d="M21 21l-4.3-4.3m1.3-5.2a6.5 6.5 0 11-13 0 6.5 6.5 0 0113 0z"
                  stroke="currentColor"
                  stroke-width="1.8"
                  stroke-linecap="round"
                />
              </svg>
            </div>
          </div>
        </form>
      </div>
    </header>

    <!-- Breadcrumb -->
    <nav class="max-w-7xl mx-auto px-4 md:px-6 mt-4 text-sm text-gray-500">
      <ol class="flex items-center gap-2">
        <li>
          <a
            href="#"
            class="hover:text-gray-700"
            onclick="event.preventDefault()"
            >Trang chủ</a
          >
        </li>
        <li class="text-gray-400">/</li>
        <li>
          <a
            href="#"
            class="hover:text-gray-700"
            onclick="event.preventDefault()"
            >Điện thoại</a
          >
        </li>
        <li class="text-gray-400">/</li>
        <li class="text-gray-700">iPhone 15</li>
      </ol>
    </nav>

    <!-- Main -->
    <main class="max-w-7xl mx-auto px-4 md:px-6 py-6 md:py-8">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8">
        <!-- Left: Gallery -->
        <section class="lg:col-span-6">
          <div
            id="stage"
            class="rounded-xl bg-white border border-gray-200 shadow-soft p-4 md:p-5"
          >
            <div
              class="aspect-square rounded-lg border border-gray-100 bg-gray-50 overflow-hidden grid place-items-center"
            >
              <!-- 3 Angles, recolored by CSS variable -->
              <div
                id="angle0"
                class="phone-svg w-full h-full flex items-center justify-center"
              >
                <svg viewBox="0 0 300 300" class="w-[82%] h-[82%]">
                  <!-- shadow -->
                  <ellipse
                    cx="150"
                    cy="260"
                    rx="80"
                    ry="18"
                    fill="rgba(0,0,0,.08)"
                  ></ellipse>
                  <!-- body -->
                  <rect
                    class="body"
                    x="95"
                    y="30"
                    width="110"
                    height="240"
                    rx="22"
                  ></rect>
                  <!-- screen -->
                  <rect
                    x="103"
                    y="60"
                    width="94"
                    height="190"
                    rx="12"
                    fill="#0B1220"
                  ></rect>
                  <!-- camera -->
                  <circle cx="150" cy="48" r="4" fill="#C7D2FE"></circle>
                  <!-- highlight -->
                  <rect
                    x="100"
                    y="40"
                    width="20"
                    height="220"
                    rx="10"
                    fill="white"
                    opacity=".08"
                  ></rect>
                </svg>
              </div>
              <div
                id="angle1"
                class="phone-svg w-full h-full hidden items-center justify-center"
              >
                <svg viewBox="0 0 300 300" class="w-[82%] h-[82%]">
                  <ellipse
                    cx="150"
                    cy="260"
                    rx="84"
                    ry="18"
                    fill="rgba(0,0,0,.08)"
                  ></ellipse>
                  <g transform="rotate(-8 150 150)">
                    <rect
                      class="body"
                      x="95"
                      y="30"
                      width="110"
                      height="240"
                      rx="22"
                    ></rect>
                    <rect
                      x="103"
                      y="60"
                      width="94"
                      height="190"
                      rx="12"
                      fill="#0B1220"
                    ></rect>
                    <circle cx="150" cy="48" r="4" fill="#C7D2FE"></circle>
                    <rect
                      x="100"
                      y="40"
                      width="20"
                      height="220"
                      rx="10"
                      fill="white"
                      opacity=".08"
                    ></rect>
                  </g>
                </svg>
              </div>
              <div
                id="angle2"
                class="phone-svg w-full h-full hidden items-center justify-center"
              >
                <svg viewBox="0 0 300 300" class="w-[82%] h-[82%]">
                  <ellipse
                    cx="150"
                    cy="260"
                    rx="84"
                    ry="18"
                    fill="rgba(0,0,0,.08)"
                  ></ellipse>
                  <g transform="rotate(12 150 150)">
                    <rect
                      class="body"
                      x="95"
                      y="30"
                      width="110"
                      height="240"
                      rx="22"
                    ></rect>
                    <rect
                      x="103"
                      y="60"
                      width="94"
                      height="190"
                      rx="12"
                      fill="#0B1220"
                    ></rect>
                    <circle cx="150" cy="48" r="4" fill="#C7D2FE"></circle>
                    <rect
                      x="100"
                      y="40"
                      width="20"
                      height="220"
                      rx="10"
                      fill="white"
                      opacity=".08"
                    ></rect>
                  </g>
                </svg>
              </div>
            </div>

            <!-- Thumbnails -->
            <div class="grid grid-cols-3 gap-3 mt-4">
              <button
                data-angle="0"
                class="thumb-btn rounded-lg overflow-hidden border border-gray-200 bg-white hover:border-primary focus-ring"
              >
                <div class="aspect-[4/3] grid place-items-center">
                  <div
                    class="w-10 h-14 rounded-md"
                    style="background: var(--phone-color)"
                  ></div>
                </div>
              </button>
              <button
                data-angle="1"
                class="thumb-btn rounded-lg overflow-hidden border border-gray-200 bg-white hover:border-primary focus-ring"
              >
                <div class="aspect-[4/3] grid place-items-center">
                  <div
                    class="w-10 h-14 rounded-md rotate-6"
                    style="background: var(--phone-color)"
                  ></div>
                </div>
              </button>
              <button
                data-angle="2"
                class="thumb-btn rounded-lg overflow-hidden border border-gray-200 bg-white hover:border-primary focus-ring"
              >
                <div class="aspect-[4/3] grid place-items-center">
                  <div
                    class="w-10 h-14 rounded-md -rotate-6"
                    style="background: var(--phone-color)"
                  ></div>
                </div>
              </button>
            </div>
          </div>
        </section>

        <!-- Right: Details -->
        <section class="lg:col-span-6">
          <div
            class="rounded-xl bg-white border border-gray-200 shadow-soft p-5 md:p-6"
          >
            <h1
              class="text-2xl md:text-3xl font-semibold tracking-tight text-gray-900"
            >
              iPhone 15
            </h1>

            <!-- Rating -->
            <div class="mt-2 flex items-center gap-3">
              <div class="flex items-center">
                <span class="sr-only">Đánh giá</span>
                <!-- 4.5 stars -->
                <div class="flex">
                  <div class="text-yellow-400">
                    <svg
                      width="18"
                      height="18"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        d="M9.05 2.927c.3-.921 1.6-.921 1.9 0l1.13 3.47a1 1 0 00.95.69h3.65c.968 0 1.37 1.24.59 1.81l-2.96 2.15a1 1 0 00-.36 1.12l1.13 3.47c.3.922-.76 1.688-1.54 1.12l-2.96-2.15a1 1 0 00-1.18 0l-2.96 2.15c-.78.57-1.84-.198-1.54-1.12l1.13-3.47a1 1 0 00-.36-1.12L2.73 8.897c-.78-.57-.38-1.81.59-1.81h3.65a1 1 0 00.95-.69l1.13-3.47z"
                      />
                    </svg>
                  </div>
                  <div class="text-yellow-400">
                    <svg
                      width="18"
                      height="18"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        d="M9.05 2.927c.3-.921 1.6-.921 1.9 0l1.13 3.47a1 1 0 00.95.69h3.65c.968 0 1.37 1.24.59 1.81l-2.96 2.15a1 1 0 00-.36 1.12l1.13 3.47c.3.922-.76 1.688-1.54 1.12l-2.96-2.15a1 1 0 00-1.18 0l-2.96 2.15c-.78.57-1.84-.198-1.54-1.12l1.13-3.47a1 1 0 00-.36-1.12L2.73 8.897c-.78-.57-.38-1.81.59-1.81h3.65a1 1 0 00.95-.69l1.13-3.47z"
                      />
                    </svg>
                  </div>
                  <div class="text-yellow-400">
                    <svg
                      width="18"
                      height="18"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        d="M9.05 2.927c.3-.921 1.6-.921 1.9 0l1.13 3.47a1 1 0 00.95.69h3.65c.968 0 1.37 1.24.59 1.81l-2.96 2.15a1 1 0 00-.36 1.12l1.13 3.47c.3.922-.76 1.688-1.54 1.12l-2.96-2.15a1 1 0 00-1.18 0l-2.96 2.15c-.78.57-1.84-.198-1.54-1.12l1.13-3.47a1 1 0 00-.36-1.12L2.73 8.897c-.78-.57-.38-1.81.59-1.81h3.65a1 1 0 00.95-.69l1.13-3.47z"
                      />
                    </svg>
                  </div>
                  <div class="text-yellow-400">
                    <svg
                      width="18"
                      height="18"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        d="M9.05 2.927c.3-.921 1.6-.921 1.9 0l1.13 3.47a1 1 0 00.95.69h3.65c.968 0 1.37 1.24.59 1.81l-2.96 2.15a1 1 0 00-.36 1.12l1.13 3.47c.3.922-.76 1.688-1.54 1.12l-2.96-2.15a1 1 0 00-1.18 0l-2.96 2.15c-.78.57-1.84-.198-1.54-1.12l1.13-3.47a1 1 0 00-.36-1.12L2.73 8.897c-.78-.57-.38-1.81.59-1.81h3.65a1 1 0 00.95-.69l1.13-3.47z"
                      />
                    </svg>
                  </div>
                  <div class="relative text-yellow-400">
                    <div
                      class="absolute inset-0 overflow-hidden"
                      style="width: 50%"
                    >
                      <svg
                        width="18"
                        height="18"
                        viewBox="0 0 20 20"
                        fill="currentColor"
                      >
                        <path
                          d="M9.05 2.927c.3-.921 1.6-.921 1.9 0l1.13 3.47a1 1 0 00.95.69h3.65c.968 0 1.37 1.24.59 1.81l-2.96 2.15a1 1 0 00-.36 1.12l1.13 3.47c.3.922-.76 1.688-1.54 1.12l-2.96-2.15a1 1 0 00-1.18 0l-2.96 2.15c-.78.57-1.84-.198-1.54-1.12l1.13-3.47a1 1 0 00-.36-1.12L2.73 8.897c-.78-.57-.38-1.81.59-1.81h3.65a1 1 0 00.95-.69l1.13-3.47z"
                        />
                      </svg>
                    </div>
                    <svg
                      width="18"
                      height="18"
                      viewBox="0 0 20 20"
                      fill="none"
                      class="text-gray-300 relative"
                    >
                      <path
                        d="M9.05 2.927c.3-.921 1.6-.921 1.9 0l1.13 3.47a1 1 0 00.95.69h3.65c.968 0 1.37 1.24.59 1.81l-2.96 2.15a1 1 0 00-.36 1.12l1.13 3.47c.3.922-.76 1.688-1.54 1.12l-2.96-2.15a1 1 0 00-1.18 0l-2.96 2.15c-.78.57-1.84-.198-1.54-1.12l1.13-3.47a1 1 0 00-.36-1.12L2.73 8.897c-.78-.57-.38-1.81.59-1.81h3.65a1 1 0 00.95-.69l1.13-3.47z"
                        stroke="currentColor"
                        stroke-width="1.2"
                      />
                    </svg>
                  </div>
                </div>
              </div>
              <button
                class="text-sm text-gray-600 hover:text-primary underline-offset-2 hover:underline"
                onclick="switchTab('reviews')"
              >
                4.5/5 • 230 đánh giá
              </button>
            </div>

            <!-- Price + Stock -->
            <div class="mt-4 flex items-end gap-3">
              <div>
                <div
                  class="text-2xl md:text-3xl font-semibold text-gray-900"
                  id="priceSale"
                >
                  23.790.000₫
                </div>
                <div class="flex items-center gap-2">
                  <span id="priceOriginal" class="text-gray-500 line-through"
                    >27.990.000₫</span
                  >
                  <span
                    id="discountPercent"
                    class="text-sm px-2 py-0.5 rounded-lg bg-red-50 text-red-600 border border-red-100"
                    >-15%</span
                  >
                </div>
              </div>
              <div class="ml-auto">
                <span
                  id="stockBadge"
                  class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm border"
                >
                  <!-- dynamic -->
                </span>
              </div>
            </div>

            <!-- Variants -->
            <div class="mt-6 space-y-5">
              <!-- Color -->
              <div>
                <div class="flex items-center justify-between mb-2">
                  <label class="font-medium text-gray-800">Màu sắc</label>
                  <span
                    id="colorSelectedLabel"
                    class="text-sm text-gray-500"
                  ></span>
                </div>
                <div id="colorOptions" class="flex flex-wrap gap-2"></div>
              </div>

              <!-- Capacity -->
              <div>
                <div class="flex items-center justify-between mb-2">
                  <label class="font-medium text-gray-800">Dung lượng</label>
                  <span
                    id="capacitySelectedLabel"
                    class="text-sm text-gray-500"
                  ></span>
                </div>
                <div id="capacityOptions" class="flex flex-wrap gap-2"></div>
              </div>

              <!-- Quantity -->
              <div class="flex items-center gap-4">
                <label class="font-medium text-gray-800">Số lượng</label>
                <div
                  class="flex items-center border border-gray-200 rounded-xl overflow-hidden"
                >
                  <button
                    id="qtyMinus"
                    class="w-10 h-10 grid place-items-center text-gray-600 hover:bg-gray-50 disabled:text-gray-400 disabled:hover:bg-white"
                    aria-label="Giảm"
                    disabled
                  >
                    -
                  </button>
                  <div id="qtyValue" class="w-12 text-center font-medium">
                    1
                  </div>
                  <button
                    id="qtyPlus"
                    class="w-10 h-10 grid place-items-center text-gray-600 hover:bg-gray-50"
                    aria-label="Tăng"
                  >
                    +
                  </button>
                </div>
              </div>

              <!-- CTAs -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-1">
                <button
                  id="buyNowBtn"
                  class="w-full px-4 py-3 rounded-xl bg-primary text-white font-semibold hover:bg-blue-700 transition focus-ring disabled:bg-gray-300 disabled:text-gray-600 disabled:cursor-not-allowed"
                >
                  Mua ngay
                </button>
                <button
                  id="addToCartBtn"
                  class="w-full px-4 py-3 rounded-xl border border-gray-200 hover:bg-gray-50 font-semibold text-gray-800 transition focus-ring disabled:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"
                >
                  Thêm vào giỏ hàng
                </button>
              </div>

              <!-- Trust -->
              <div
                class="flex flex-wrap items-center gap-4 text-sm text-gray-600"
              >
                <div class="inline-flex items-center gap-2">
                  <span
                    class="w-7 h-7 rounded-lg bg-blue-50 text-primary grid place-items-center"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                    >
                      <path
                        d="M12 2l7 4v6c0 5-3.5 9-7 10-3.5-1-7-5-7-10V6l7-4z"
                      />
                    </svg>
                  </span>
                  Bảo hành chính hãng 12T
                </div>
                <div class="inline-flex items-center gap-2">
                  <span
                    class="w-7 h-7 rounded-lg bg-blue-50 text-primary grid place-items-center"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                    >
                      <path d="M3 12h18M3 12l5 5M3 12l5-5" />
                    </svg>
                  </span>
                  Đổi trả 7 ngày
                </div>
                <div class="inline-flex items-center gap-2">
                  <span
                    class="w-7 h-7 rounded-lg bg-blue-50 text-primary grid place-items-center"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                    >
                      <path d="M3 6h18v12H3z M7 10h4v4H7z" />
                    </svg>
                  </span>
                  Giao nhanh, miễn phí
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Tabs -->
      <section class="mt-8">
        <div class="rounded-xl bg-white border border-gray-200 shadow-soft">
          <div class="px-5 md:px-6 pt-4 border-b border-gray-100">
            <nav class="flex gap-2 md:gap-4">
              <button
                data-tab="desc"
                class="tab-btn px-3 md:px-4 py-2 rounded-lg text-sm md:text-base font-medium hover:bg-gray-50 tab-active"
              >
                Mô tả chi tiết
              </button>
              <button
                data-tab="specs"
                class="tab-btn px-3 md:px-4 py-2 rounded-lg text-sm md:text-base font-medium hover:bg-gray-50"
              >
                Thông số kỹ thuật
              </button>
              <button
                data-tab="reviews"
                class="tab-btn px-3 md:px-4 py-2 rounded-lg text-sm md:text-base font-medium hover:bg-gray-50"
              >
                Đánh giá từ khách hàng
              </button>
            </nav>
          </div>
          <div class="p-5 md:p-6">
            <!-- Desc -->
            <div id="tab-desc" class="tab-panel">
              <p class="text-gray-700 leading-relaxed">
                iPhone 15 mang đến hiệu năng mạnh mẽ, camera nâng cấp và thiết
                kế hiện đại. Màn hình đẹp, pin bền bỉ, công nghệ an toàn Face
                ID, cùng cổng USB‑C tiện dụng.
              </p>
              <ul class="mt-4 space-y-2 text-gray-700">
                <li>• Màn hình Super Retina XDR 6.1"</li>
                <li>• Chip A16 Bionic mượt mà</li>
                <li>• Camera kép 48MP sắc nét</li>
                <li>• Pin dùng thoải mái cả ngày</li>
              </ul>
            </div>
            <!-- Specs -->
            <div id="tab-specs" class="tab-panel hidden">
              <dl
                class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 text-gray-700"
              >
                <div class="flex justify-between border-b border-gray-100 pb-2">
                  <dt class="text-gray-500">Màn hình</dt>
                  <dd>6.1" OLED</dd>
                </div>
                <div class="flex justify-between border-b border-gray-100 pb-2">
                  <dt class="text-gray-500">Chip</dt>
                  <dd>A16 Bionic</dd>
                </div>
                <div class="flex justify-between border-b border-gray-100 pb-2">
                  <dt class="text-gray-500">Camera sau</dt>
                  <dd>48MP + 12MP</dd>
                </div>
                <div class="flex justify-between border-b border-gray-100 pb-2">
                  <dt class="text-gray-500">Camera trước</dt>
                  <dd>12MP</dd>
                </div>
                <div class="flex justify-between border-b border-gray-100 pb-2">
                  <dt class="text-gray-500">Pin</dt>
                  <dd>~3349 mAh</dd>
                </div>
                <div class="flex justify-between border-b border-gray-100 pb-2">
                  <dt class="text-gray-500">Cổng</dt>
                  <dd>USB‑C</dd>
                </div>
              </dl>
            </div>
            <!-- Reviews -->
            <div id="tab-reviews" class="tab-panel hidden">
              <div class="space-y-4">
                <div class="p-4 border border-gray-100 rounded-xl">
                  <div class="flex items-center justify-between">
                    <div class="font-medium">Ngọc Anh</div>
                    <div class="text-yellow-400 text-sm">★★★★★</div>
                  </div>
                  <p class="mt-2 text-gray-700">
                    Máy mượt, pin ổn, màu xanh rất đẹp. Giao hàng nhanh.
                  </p>
                </div>
                <div class="p-4 border border-gray-100 rounded-xl">
                  <div class="flex items-center justify-between">
                    <div class="font-medium">Minh Khoa</div>
                    <div class="text-yellow-400 text-sm">★★★★☆</div>
                  </div>
                  <p class="mt-2 text-gray-700">
                    Chụp ảnh tốt, đổi cổng USB‑C tiện. Giá ổn khi có khuyến mãi.
                  </p>
                </div>
                <button
                  class="mt-2 px-4 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-sm"
                  onclick="showToast('Đã tải thêm đánh giá (demo)')"
                >
                  Xem thêm đánh giá
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Related -->
      <section class="mt-8">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-xl font-semibold">Sản phẩm liên quan</h2>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <!-- Card 1 -->
          <div
            class="rounded-xl bg-white border border-gray-200 p-4 shadow-soft"
          >
            <div
              class="aspect-square rounded-lg bg-gray-50 border border-gray-100 grid place-items-center"
            >
              <svg viewBox="0 0 120 120" class="w-20 h-20">
                <rect
                  x="40"
                  y="10"
                  width="40"
                  height="100"
                  rx="10"
                  fill="#1F2937"
                />
                <rect
                  x="44"
                  y="26"
                  width="32"
                  height="68"
                  rx="8"
                  fill="#0B1220"
                />
              </svg>
            </div>
            <div class="mt-3 space-y-1">
              <div class="font-medium line-clamp-2">iPhone 15 Plus</div>
              <div class="text-primary font-semibold">26.990.000₫</div>
              <button
                class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-sm"
                onclick="addRelated('iPhone 15 Plus', 26990000)"
              >
                Thêm giỏ
              </button>
            </div>
          </div>
          <!-- Card 2 -->
          <div
            class="rounded-xl bg-white border border-gray-200 p-4 shadow-soft"
          >
            <div
              class="aspect-square rounded-lg bg-gray-50 border border-gray-100 grid place-items-center"
            >
              <svg viewBox="0 0 120 120" class="w-20 h-20">
                <rect
                  x="40"
                  y="10"
                  width="40"
                  height="100"
                  rx="10"
                  fill="#2563EB"
                />
                <rect
                  x="44"
                  y="26"
                  width="32"
                  height="68"
                  rx="8"
                  fill="#0B1220"
                />
              </svg>
            </div>
            <div class="mt-3 space-y-1">
              <div class="font-medium line-clamp-2">iPhone 14</div>
              <div class="text-primary font-semibold">17.990.000₫</div>
              <button
                class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-sm"
                onclick="addRelated('iPhone 14', 17990000)"
              >
                Thêm giỏ
              </button>
            </div>
          </div>
          <!-- Card 3 -->
          <div
            class="rounded-xl bg-white border border-gray-200 p-4 shadow-soft"
          >
            <div
              class="aspect-square rounded-lg bg-gray-50 border border-gray-100 grid place-items-center"
            >
              <svg viewBox="0 0 120 120" class="w-20 h-20">
                <rect
                  x="40"
                  y="10"
                  width="40"
                  height="100"
                  rx="10"
                  fill="#F472B6"
                />
                <rect
                  x="44"
                  y="26"
                  width="32"
                  height="68"
                  rx="8"
                  fill="#0B1220"
                />
              </svg>
            </div>
            <div class="mt-3 space-y-1">
              <div class="font-medium line-clamp-2">iPhone 15 (Pink)</div>
              <div class="text-primary font-semibold">23.790.000₫</div>
              <button
                class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-sm"
                onclick="addRelated('iPhone 15 (Pink)', 23790000)"
              >
                Thêm giỏ
              </button>
            </div>
          </div>
          <!-- Card 4 -->
          <div
            class="rounded-xl bg-white border border-gray-200 p-4 shadow-soft"
          >
            <div
              class="aspect-square rounded-lg bg-gray-50 border border-gray-100 grid place-items-center"
            >
              <svg viewBox="0 0 120 120" class="w-20 h-20">
                <rect
                  x="40"
                  y="10"
                  width="40"
                  height="100"
                  rx="10"
                  fill="#111827"
                />
                <rect
                  x="44"
                  y="26"
                  width="32"
                  height="68"
                  rx="8"
                  fill="#0B1220"
                />
              </svg>
            </div>
            <div class="mt-3 space-y-1">
              <div class="font-medium line-clamp-2">iPhone 13</div>
              <div class="text-primary font-semibold">12.990.000₫</div>
              <button
                class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-sm"
                onclick="addRelated('iPhone 13', 12990000)"
              >
                Thêm giỏ
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Buy Now Modal (Demo) -->
    <div id="buyModal" class="fixed inset-0 z-50 hidden">
      <div
        class="absolute inset-0 bg-black/40"
        onclick="toggleBuyModal(false)"
      ></div>
      <div
        class="absolute inset-x-0 bottom-0 md:inset-0 md:grid md:place-items-center"
      >
        <div
          class="md:max-w-lg w-full md:w-[520px] bg-white rounded-t-2xl md:rounded-2xl shadow-soft border border-gray-200 p-5 md:p-6"
        >
          <div class="flex items-start justify-between">
            <h3 class="text-lg font-semibold">Xác nhận mua nhanh (demo)</h3>
            <button
              class="p-2 rounded-lg hover:bg-gray-100"
              onclick="toggleBuyModal(false)"
            >
              ✕
            </button>
          </div>
          <div class="mt-3 text-gray-700 space-y-1">
            <div>Sản phẩm: <span class="font-medium">iPhone 15</span></div>
            <div>
              Biến thể: <span id="summaryVariant" class="font-medium"></span>
            </div>
            <div>
              Số lượng: <span id="summaryQty" class="font-medium"></span>
            </div>
            <div>
              Tạm tính:
              <span
                id="summarySubtotal"
                class="font-semibold text-primary"
              ></span>
            </div>
          </div>
          <div class="mt-5 grid grid-cols-2 gap-3">
            <button
              class="px-4 py-3 rounded-xl border border-gray-200 hover:bg-gray-50"
              onclick="toggleBuyModal(false)"
            >
              Tiếp tục mua
            </button>
            <button
              class="px-4 py-3 rounded-xl bg-primary text-white hover:bg-blue-700"
              onclick="demoCheckout()"
            >
              Thanh toán (demo)
            </button>
          </div>
          <p class="mt-3 text-xs text-gray-500">
            Đây là mô phỏng trong Canva Code (không có thanh toán thật).
          </p>
        </div>
      </div>
    </div>

    <script>
      // App State
      const state = {
        productName: "iPhone 15",
        colors: [
          { id: "den", name: "Đen", hex: "#111827" },
          { id: "xanh", name: "Xanh", hex: "#2563EB" },
          { id: "hong", name: "Hồng", hex: "#F472B6" },
        ],
        capacities: ["128GB", "256GB", "512GB"],
        selected: { color: "den", capacity: "128GB", angle: 0, qty: 1 },
        stockMap: {
          "den-128GB": true,
          "den-256GB": true,
          "den-512GB": true,
          "xanh-128GB": true,
          "xanh-256GB": true,
          "xanh-512GB": false,
          "hong-128GB": true,
          "hong-256GB": false,
          "hong-512GB": false,
        },
        pricing: {
          baseOriginal: 27990000,
          discount: 0.15,
          addon: { "128GB": 0, "256GB": 2000000, "512GB": 4000000 },
        },
        cart: [],
      };

      // Helpers
      const fmt = new Intl.NumberFormat("vi-VN", {
        style: "currency",
        currency: "VND",
        maximumFractionDigits: 0,
      });
      const $ = (s, p = document) => p.querySelector(s);
      const $$ = (s, p = document) => Array.from(p.querySelectorAll(s));
      const variantKey = () =>
        `${state.selected.color}-${state.selected.capacity}`;
      const hasStock = () => !!state.stockMap[variantKey()];
      const currentOriginal = () =>
        state.pricing.baseOriginal +
        (state.pricing.addon[state.selected.capacity] || 0);
      const currentSale = () =>
        Math.round(currentOriginal() * (1 - state.pricing.discount));

      function showToast(text, ok = true) {
        const toast = $("#toast");
        $("#toastText").textContent = text;
        const icon = $("#toastIcon");
        icon.textContent = ok ? "✓" : "!";
        icon.className =
          "w-5 h-5 rounded-full grid place-items-center " +
          (ok ? "bg-primary text-white" : "bg-red-500 text-white");
        toast.classList.remove("hidden");
        clearTimeout(toast._t);
        toast._t = setTimeout(() => toast.classList.add("hidden"), 1800);
      }

      // Mini-cart
      function toggleMiniCart(force) {
        const el = $("#miniCart");
        const show =
          typeof force === "boolean" ? force : el.classList.contains("hidden");
        el.classList.toggle("hidden", !show);
      }
      $("#cartBtn").addEventListener("click", () => toggleMiniCart());

      function updateMiniCart() {
        const list = $("#miniCartList");
        list.innerHTML = "";
        if (state.cart.length === 0) {
          list.innerHTML =
            '<p class="text-gray-500 text-sm">Chưa có sản phẩm nào.</p>';
        } else {
          state.cart.forEach((item, idx) => {
            const div = document.createElement("div");
            div.className = "flex items-center justify-between gap-3";
            div.innerHTML = `
            <div class="flex-1">
              <div class="text-sm font-medium">${item.name}</div>
              <div class="text-xs text-gray-500">${item.color} • ${
              item.capacity
            } • SL: ${item.qty}</div>
            </div>
            <div class="text-sm font-semibold text-gray-800">${fmt.format(
              item.price * item.qty
            )}</div>
            <button class="text-gray-400 hover:text-red-500" aria-label="Xóa">✕</button>
          `;
            div.querySelector("button").addEventListener("click", () => {
              state.cart.splice(idx, 1);
              updateCartCount();
              updateMiniCart();
            });
            list.appendChild(div);
          });
        }
        const subtotal = state.cart.reduce((s, it) => s + it.price * it.qty, 0);
        $("#miniCartSubtotal").textContent = fmt.format(subtotal);
      }

      function updateCartCount() {
        const count = state.cart.reduce((s, it) => s + it.qty, 0);
        $("#cartCount").textContent = count;
      }

      function addToCart() {
        if (!hasStock()) return;
        const item = {
          name: state.productName,
          color: state.colors.find((c) => c.id === state.selected.color).name,
          capacity: state.selected.capacity,
          qty: state.selected.qty,
          price: currentSale(),
        };
        // Merge with existing same variant
        const idx = state.cart.findIndex(
          (it) =>
            it.name === item.name &&
            it.color === item.color &&
            it.capacity === item.capacity
        );
        if (idx >= 0) state.cart[idx].qty += item.qty;
        else state.cart.push(item);
        updateCartCount();
        updateMiniCart();
        showToast("Đã thêm vào giỏ hàng!");
      }

      function addRelated(name, price) {
        const item = { name, color: "Mặc định", capacity: "-", qty: 1, price };
        const idx = state.cart.findIndex((it) => it.name === name);
        if (idx >= 0) state.cart[idx].qty += 1;
        else state.cart.push(item);
        updateCartCount();
        updateMiniCart();
        showToast(`Đã thêm ${name} vào giỏ`);
      }

      // Render variants
      function renderColorOptions() {
        const wrap = $("#colorOptions");
        wrap.innerHTML = "";
        state.colors.forEach((c) => {
          const btn = document.createElement("button");
          const active = c.id === state.selected.color;
          btn.className = `px-3 py-2 rounded-xl border ${
            active
              ? "border-primary bg-blue-50"
              : "border-gray-200 bg-white hover:bg-gray-50"
          } flex items-center gap-2 focus-ring`;
          btn.setAttribute("aria-pressed", active ? "true" : "false");
          btn.innerHTML = `
          <span class="w-5 h-5 rounded-full border border-gray-200" style="background:${c.hex}"></span>
          <span class="text-sm">${c.name}</span>
        `;
          btn.addEventListener("click", () => {
            state.selected.color = c.id;
            document.documentElement.style.setProperty("--phone-color", c.hex);
            $("#colorSelectedLabel").textContent = c.name;
            renderColorOptions();
            updatePriceAndStock();
            updateAngleThumbsColor();
          });
          wrap.appendChild(btn);
        });
        const currentColor = state.colors.find(
          (c) => c.id === state.selected.color
        );
        $("#colorSelectedLabel").textContent = currentColor?.name || "";
        document.documentElement.style.setProperty(
          "--phone-color",
          currentColor.hex
        );
      }

      function renderCapacityOptions() {
        const wrap = $("#capacityOptions");
        wrap.innerHTML = "";
        state.capacities.forEach((cap) => {
          const active = cap === state.selected.capacity;
          const disabled = !state.stockMap[`${state.selected.color}-${cap}`]; // preview stock per capacity
          const btn = document.createElement("button");
          btn.className = `px-3 py-2 rounded-xl border ${
            active
              ? "border-primary bg-blue-50"
              : "border-gray-200 bg-white hover:bg-gray-50"
          } text-sm focus-ring ${
            disabled ? "opacity-60 cursor-not-allowed" : ""
          }`;
          btn.textContent = cap;
          if (!disabled) {
            btn.addEventListener("click", () => {
              state.selected.capacity = cap;
              $("#capacitySelectedLabel").textContent = cap;
              renderCapacityOptions();
              updatePriceAndStock();
            });
          }
          wrap.appendChild(btn);
        });
        $("#capacitySelectedLabel").textContent = state.selected.capacity;
      }

      function renderQty() {
        $("#qtyValue").textContent = state.selected.qty;
        $("#qtyMinus").disabled = state.selected.qty <= 1;
      }

      function updatePriceAndStock() {
        const original = currentOriginal();
        const sale = currentSale();
        const discountPct = Math.round((1 - sale / original) * 100);
        $("#priceOriginal").textContent = fmt.format(original);
        $("#priceSale").textContent = fmt.format(sale);
        $("#discountPercent").textContent = `-${discountPct}%`;

        // Stock badge + buttons
        const badge = $("#stockBadge");
        if (hasStock()) {
          badge.className =
            "inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm border bg-green-50 text-green-700 border-green-200";
          badge.innerHTML = `<span class="w-2 h-2 rounded-full bg-green-500"></span> Còn hàng`;
          $("#buyNowBtn").disabled = false;
          $("#addToCartBtn").disabled = false;
        } else {
          badge.className =
            "inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm border bg-red-50 text-red-700 border-red-200";
          badge.innerHTML = `<span class="w-2 h-2 rounded-full bg-red-500"></span> Hết hàng`;
          $("#buyNowBtn").disabled = true;
          $("#addToCartBtn").disabled = true;
        }
      }

      function switchTab(name) {
        $$(".tab-panel").forEach((p) => p.classList.add("hidden"));
        $(`#tab-${name}`).classList.remove("hidden");
        $$(".tab-btn").forEach((b) => b.classList.remove("tab-active"));
        document
          .querySelector(`[data-tab="${name}"]`)
          .classList.add("tab-active");
        // Scroll into view for better UX on mobile
        $(`#tab-${name}`).scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }

      // Gallery
      function updateAngle(angle) {
        state.selected.angle = angle;
        ["angle0", "angle1", "angle2"].forEach((id, i) => {
          const el = $("#" + id);
          if (i === angle) {
            el.classList.remove("hidden");
            el.classList.add("flex");
          } else {
            el.classList.add("hidden");
            el.classList.remove("flex");
          }
        });
        // update thumbs style
        $$(".thumb-btn").forEach((btn) => {
          if (Number(btn.dataset.angle) === angle)
            btn.classList.add("thumb-selected");
          else btn.classList.remove("thumb-selected");
        });
      }
      function updateAngleThumbsColor() {
        // Update thumbnail swatches background to current color
        $$(".thumb-btn div>div[style]").forEach((div) => {
          div.style.background = getColorHex(state.selected.color);
        });
      }
      function getColorHex(colorId) {
        return (
          (state.colors.find((c) => c.id === colorId) || {}).hex || "#111827"
        );
      }

      // Buy Now modal
      function toggleBuyModal(show) {
        $("#buyModal").classList.toggle("hidden", !show);
        if (show) {
          $("#summaryVariant").textContent = `${
            state.colors.find((c) => c.id === state.selected.color).name
          } • ${state.selected.capacity}`;
          $("#summaryQty").textContent = state.selected.qty;
          $("#summarySubtotal").textContent = fmt.format(
            state.selected.qty * currentSale()
          );
        }
      }
      function demoCheckout() {
        showToast("Đây là mô phỏng thanh toán trong Canva Code", true);
        toggleBuyModal(false);
      }

      // Event bindings
      function bindEvents() {
        // Tabs
        $$(".tab-btn").forEach((btn) =>
          btn.addEventListener("click", () => switchTab(btn.dataset.tab))
        );

        // Thumbs
        $$(".thumb-btn").forEach((btn) =>
          btn.addEventListener("click", () =>
            updateAngle(Number(btn.dataset.angle))
          )
        );

        // Qty
        $("#qtyMinus").addEventListener("click", () => {
          if (state.selected.qty > 1) {
            state.selected.qty -= 1;
            renderQty();
          }
        });
        $("#qtyPlus").addEventListener("click", () => {
          state.selected.qty += 1;
          renderQty();
        });

        // CTAs
        $("#addToCartBtn").addEventListener("click", () => {
          addToCart();
        });
        $("#buyNowBtn").addEventListener("click", () => {
          if (!hasStock()) return;
          toggleBuyModal(true);
        });

        // Search
        $("#searchForm")?.addEventListener("submit", (e) => {
          e.preventDefault();
          const q = $("#searchInput").value?.trim();
          showToast(q ? `Tìm kiếm: ${q}` : "Nhập từ khóa để tìm kiếm", !!q);
        });
        $("#searchFormMobile")?.addEventListener("submit", (e) => {
          e.preventDefault();
          const q = $("#searchInputMobile").value?.trim();
          showToast(q ? `Tìm kiếm: ${q}` : "Nhập từ khóa để tìm kiếm", !!q);
        });

        // Close mini cart when clicking outside
        document.addEventListener("click", (e) => {
          const mc = $("#miniCart");
          const btn = $("#cartBtn");
          if (!mc.contains(e.target) && !btn.contains(e.target)) {
            mc.classList.add("hidden");
          }
        });
      }

      // Init
      function init() {
        renderColorOptions();
        renderCapacityOptions();
        renderQty();
        updatePriceAndStock();
        updateAngle(0);
        updateMiniCart();
        updateCartCount();
      }

      document.addEventListener("DOMContentLoaded", () => {
        bindEvents();
        init();
      });
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'98384ffc85976034',t:'MTc1ODYxMjM3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
